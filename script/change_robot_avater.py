# -*- coding: utf-8 -*-
"""
修改机器人头像
"""

import sys
import random
reload(sys)
sys.setdefaultencoding( "utf-8" )
import db
import time
import hashlib
from qiniu import Auth
from qiniu import BucketManager
from db import transaction
import conf
import utils
import json
logger = utils.get_logger(conf.log_path)

access_key = 'h8BESeO6mxQNX-DjMS2YdCBXhwY_c2faJcpq572H'
secret_key = 'dPorICJ8l_oGsRcnFSF0lGuCgmYXJ8qWGRZuRjy3'
q = Auth(access_key, secret_key)
bucket = BucketManager(q)
bucket_name = 'shopping'


@transaction(is_commit=True)
def change_robot_avater(mysql_cursor):
    mysql_db = db.MysqlDbUtil(mysql_cursor)
    players = mysql_db.query("SELECT `userprofilebasic_ptr_id` "
                             "FROM `game_player` WHERE `is_robot` = 1 ")
    for row in players:
        user = mysql_db.get("SELECT `headimage` FROM `user_profile_basic` "
                            "WHERE `id` = {}".format(row[0]))
        source = user[0]
        # m2 = hashlib.md5()
        # m2.update(source.split("/")[-1].split(".")[0])
        destination = "headimg/{}.jpg".format(('%.6f' % time.time()).replace(".", ""))
        # 骑牛修改成功再修改数据库
        change_qiniu_name(source, destination)
        data = {
            "id": row[0],
            "headimage": destination,
        }
        mysql_db.update(data, table_name="user_profile_basic")


def change_qiniu_name(source, destination):
    ret, info = bucket.move(bucket_name, source.decode('utf-8'), bucket_name, destination)
    assert ret == {}


@transaction(is_commit=True)
def set_default_avater(mysql_cursor):
    mysql_db = db.MysqlDbUtil(mysql_cursor)
    players = mysql_db.query("SELECT `userprofilebasic_ptr_id` "
                             "FROM `game_player` WHERE `is_robot` = 1 ")
    for row in players:
        x = random.randint(1, 10)
        if x < 5:
            data = {
                "id": row[0],
                "headimage": 'headimg/default1.jpg',
            }
            mysql_db.update(data, table_name="user_profile_basic")


@transaction(is_commit=True)
def modify_avater(mysql_cursor):
    s = "headimg/1559659598289384.jpg,headimg/1559659604433232.jpg,headimg/1559659604904813.jpg,headimg/1559659607560178.jpg,headimg/1559659609035125.jpg,headimg/1559659611098775.jpg,headimg/1559659612242918.jpg,headimg/1559659613916548.jpg,headimg/1559659615638495.jpg,headimg/1559659617739535.jpg,headimg/1559659619911137.jpg,headimg/1559659620322982.jpg,headimg/1559659620973182.jpg,headimg/1559659621541125.jpg,headimg/1559659621732470.jpg,headimg/1559659622199621.jpg,headimg/1559659622457445.jpg,headimg/1559659622730344.jpg,headimg/1559659623165697.jpg,headimg/1559659623413121.jpg,headimg/1559659623662332.jpg,headimg/1559659624317342.jpg,headimg/1559659625189935.jpg,headimg/1559659626066243.jpg,headimg/1559659627125589.jpg,headimg/1559659627383865.jpg,headimg/1559659630266655.jpg,headimg/1559659631587685.jpg,headimg/1559659631856555.jpg,headimg/1559659632531074.jpg,headimg/1559659633871675.jpg,headimg/1559659634235422.jpg,headimg/1559659634816355.jpg,headimg/1559659636105270.jpg,headimg/1559659637847861.jpg,headimg/1559659638292089.jpg,headimg/1559659638946785.jpg,headimg/1559659640082750.jpg,headimg/1559659640492267.jpg,headimg/1559659640861379.jpg,headimg/1559659641783915.jpg,headimg/1559659643218013.jpg,headimg/1559659643683390.jpg,headimg/1559659643893832.jpg,headimg/1559659644732190.jpg,headimg/1559659645504553.jpg,headimg/1559659646275732.jpg,headimg/1559659646587566.jpg,headimg/1559659646952681.jpg,headimg/1559659648540475.jpg,headimg/1559659652979327.jpg,headimg/1559659653339996.jpg,headimg/1559659654005930.jpg,headimg/1559659657300853.jpg,headimg/1559659658474999.jpg,headimg/1559659658755083.jpg,headimg/1559659659102515.jpg,headimg/1559659659486812.jpg,headimg/1559659660102632.jpg,headimg/1559659661922450.jpg,headimg/1559659663784410.jpg,headimg/1559659664217401.jpg,headimg/1559659665759739.jpg,headimg/1559659666011142.jpg,headimg/1559659667219930.jpg,headimg/1559659667806026.jpg,headimg/1559659669906618.jpg,headimg/1559659670633907.jpg,headimg/1559659671017550.jpg,headimg/1559659671384861.jpg,headimg/1559659673240514.jpg,headimg/1559659673504061.jpg,headimg/1559659673985299.jpg,headimg/1559659674280250.jpg,headimg/1559659674568984.jpg,headimg/1559659675007989.jpg,headimg/1559659675206661.jpg,headimg/1559659675480873.jpg,headimg/1559659676047084.jpg,headimg/1559659676296925.jpg,headimg/1559659677578429.jpg,headimg/1559659677761093.jpg,headimg/1559659678124718.jpg,headimg/1559659678726584.jpg,headimg/1559659679006910.jpg,headimg/1559659679274735.jpg,headimg/1559659680552549.jpg,headimg/1559659680836846.jpg,headimg/1559659681385274.jpg,headimg/1559659681699184.jpg,headimg/1559659681972912.jpg,headimg/1559659683192376.jpg,headimg/1559659683626505.jpg,headimg/1559659684303085.jpg,headimg/1559659685589924.jpg,headimg/1559659687428100.jpg,headimg/1559659688714367.jpg,headimg/1559659689000134.jpg,headimg/1559659689218067.jpg,headimg/1559659689917676.jpg,headimg/1559659690252183.jpg,headimg/1559659692020155.jpg,headimg/1559659692591348.jpg,headimg/1559659693233729.jpg,headimg/1559659693421897.jpg,headimg/1559659696632632.jpg,headimg/1559659704839105.jpg,headimg/1559659705043890.jpg,headimg/1559659705321976.jpg,headimg/1559659706590421.jpg,headimg/1559659708111338.jpg,headimg/1559659708570560.jpg,headimg/1559659709103445.jpg,headimg/1559659710047788.jpg,headimg/1559659710355619.jpg,headimg/1559659716395762.jpg,headimg/1559659716586930.jpg,headimg/1559659716749110.jpg,headimg/1559659717036706.jpg,headimg/1559659717281867.jpg,headimg/1559659718584985.jpg,headimg/1559659719826487.jpg,headimg/1559659720586856.jpg,headimg/1559659721077364.jpg,headimg/1559659721692152.jpg,headimg/1559659722052584.jpg,headimg/1559659722297516.jpg,headimg/1559659722553248.jpg,headimg/1559659723214002.jpg,headimg/1559659723486645.jpg,headimg/1559659723916717.jpg,headimg/1559659727215370.jpg,headimg/1559659727762969.jpg,headimg/1559659728011626.jpg,headimg/1559659729508986.jpg,headimg/1559659729761930.jpg,headimg/1559659731078719.jpg,headimg/1559659731687604.jpg,headimg/1559659732937890.jpg,headimg/1559659733286825.jpg,headimg/1559659734477329.jpg,headimg/1559659734867221.jpg,headimg/1559659735110155.jpg,headimg/1559659736463805.jpg,headimg/1559659736900363.jpg,headimg/1559659737270028.jpg,headimg/1559659737559254.jpg,headimg/1559659737744991.jpg,headimg/1559659737985016.jpg,headimg/1559659738328254.jpg,headimg/1559659738666458.jpg,headimg/1559659739222352.jpg,headimg/1559659739550365.jpg,headimg/1559659739800871.jpg,headimg/1559659740086247.jpg,headimg/1559659740231479.jpg,headimg/1559659740374676.jpg,headimg/1559659740959734.jpg,headimg/1559659741166036.jpg,headimg/1559659742405284.jpg,headimg/1559659744960329.jpg,headimg/1559659745594922.jpg,headimg/1559659747856048.jpg,headimg/1559659749959847.jpg,headimg/1559659756379154.jpg,headimg/1559659756782017.jpg,headimg/1559659757084843.jpg,headimg/1559659757736850.jpg,headimg/1559659758277630.jpg,headimg/1559659758922939.jpg,headimg/1559659759562890.jpg,headimg/1559659759766814.jpg,headimg/1559659759961532.jpg,headimg/1559659760106540.jpg,headimg/1559659760294840.jpg,headimg/1559659760751079.jpg,headimg/1559659761069847.jpg,headimg/1559659761237293.jpg,headimg/1559659761580422.jpg,headimg/1559659762379106.jpg,headimg/1559659762577956.jpg,headimg/1559659762773772.jpg,headimg/1559659763222761.jpg,headimg/1559659763467015.jpg,headimg/1559659763713597.jpg,headimg/1559659763979803.jpg,headimg/1559659764331872.jpg,headimg/1559659764980473.jpg,headimg/1559659766211695.jpg,headimg/1559659766429716.jpg,headimg/1559659766780138.jpg,headimg/1559659767022925.jpg,headimg/1559659767484557.jpg,headimg/1559659768632799.jpg,headimg/1559659769126492.jpg,headimg/1559659769392222.jpg,headimg/1559659770350156.jpg,headimg/1559659770598987.jpg,headimg/1559659770966020.jpg,headimg/1559659771105215.jpg,headimg/1559659771259441.jpg,headimg/1559659773852408.jpg,headimg/1559659774123594.jpg,headimg/1559659774439018.jpg,headimg/1559659774732206.jpg,headimg/1559659775179355.jpg,headimg/1559660764098919.jpg,headimg/1559660766018176.jpg,headimg/1559660766298812.jpg,headimg/1559660766938876.jpg,headimg/1559660768172897.jpg,headimg/1559660768607855.jpg,headimg/1559660769322701.jpg,headimg/1559660770497425.jpg,headimg/1559660770956682.jpg,headimg/1559660771611777.jpg,headimg/1559660771889511.jpg,headimg/1559660772302917.jpg,headimg/1559660772529165.jpg,headimg/1559660772791401.jpg,headimg/1559660773249343.jpg,headimg/1559660775456802.jpg,headimg/1559660775923728.jpg,headimg/1559660776630077.jpg,headimg/1559660780491901.jpg,headimg/1559660781587182.jpg,headimg/1559660782231698.jpg,headimg/1559660782861071.jpg,headimg/1559660783632438.jpg,headimg/1559660784211859.jpg,headimg/1559660785482503.jpg,headimg/1559660786139802.jpg,headimg/1559660786641429.jpg,headimg/1559660789332950.jpg,headimg/1559660792846749.jpg,headimg/1559660793275998.jpg,headimg/1559660793793146.jpg,headimg/1559660795813204.jpg,headimg/1559660798170479.jpg,headimg/1559660798755908.jpg,headimg/1559660799144270.jpg,headimg/1559660800902922.jpg,headimg/1559660801358602.jpg,headimg/1559660802149057.jpg,headimg/1559660802803382.jpg,headimg/1559660803420586.jpg,headimg/1559660803875274.jpg,headimg/1559660804337787.jpg,headimg/1559660806952116.jpg,headimg/1559660811500904.jpg,headimg/1559660820184341.jpg,headimg/1559660821438015.jpg,headimg/1559660822974923.jpg,headimg/1559660823735094.jpg,headimg/1559660823951838.jpg,headimg/1559660824523148.jpg,headimg/1559660825078374.jpg,headimg/1559660825432647.jpg,headimg/1559660825776957.jpg,headimg/1559660826417332.jpg,headimg/1559660827091100.jpg,headimg/1559660827454098.jpg,headimg/1559660827857519.jpg,headimg/1559660828136322.jpg,headimg/1559660828485926.jpg,headimg/1559660828701600.jpg,headimg/1559660829021967.jpg,headimg/1559660829370008.jpg,headimg/1559660829839695.jpg,headimg/1559660830396422.jpg,headimg/1559660830953035.jpg,headimg/1559660833620782.jpg,headimg/1559660833884891.jpg,headimg/1559660834468964.jpg,headimg/1559660835028113.jpg,headimg/1559660835630309.jpg,headimg/1559660835878140.jpg,headimg/1559660836160539.jpg,headimg/1559660836809216.jpg,headimg/1559660837063074.jpg,headimg/1559660838174441.jpg,headimg/1559660838434124.jpg,headimg/1559660838791215.jpg,headimg/1559660839140552.jpg,headimg/1559660839792556.jpg,headimg/1559660840051154.jpg,headimg/1559660840327587.jpg,headimg/1559660840596301.jpg,headimg/1559660840814142.jpg,headimg/1559660841128581.jpg,headimg/1559660841393817.jpg,headimg/1559660841611708.jpg,headimg/1559660841885324.jpg,headimg/1559660843034621.jpg,headimg/1559660843724720.jpg,headimg/1559660846307884.jpg,headimg/1559660846839503.jpg,headimg/1559660847293323.jpg,headimg/1559660848064181.jpg,headimg/1559660852172642.jpg,headimg/1559660855060314.jpg,headimg/1559660855456192.jpg,headimg/1559660856321010.jpg,headimg/1559660860921340.jpg,headimg/1559660861581413.jpg,headimg/1559660862023875.jpg,headimg/1559660871509302.jpg,headimg/1559660872327294.jpg,headimg/1559660873055686.jpg,headimg/1559660874591305.jpg,headimg/1559660875561798.jpg,headimg/1559660875919552.jpg,headimg/1559660879001881.jpg,headimg/1559660879979273.jpg,headimg/1559660880684834.jpg,headimg/1559660881241035.jpg,headimg/1559660881850804.jpg,headimg/1559660882305663.jpg,headimg/1559660888888716.jpg,headimg/1559660889390285.jpg,headimg/1559660889735989.jpg,headimg/1559660890055775.jpg,headimg/1559660891011956.jpg,headimg/1559660891264842.jpg,headimg/1559660891519963.jpg,headimg/1559660896284964.jpg,headimg/1559660899145805.jpg,headimg/1559660900326970.jpg,headimg/1559660902300092.jpg,headimg/1559660905261455.jpg,headimg/1559660906339063.jpg,headimg/1559660906794854.jpg,headimg/1559660911993949.jpg,headimg/1559660912422363.jpg,headimg/1559660914551428.jpg,headimg/1559660915227368.jpg,headimg/1559660915687404.jpg,headimg/1559660916359706.jpg,headimg/1559660916679212.jpg,headimg/1559660917122418.jpg,headimg/1559660917703503.jpg,headimg/1559660919227808.jpg,headimg/1559660920489114.jpg,headimg/1559660922942470.jpg,headimg/1559660924318299.jpg,headimg/1559660925577214.jpg,headimg/1559660926234034.jpg,headimg/1559660926799098.jpg,headimg/1559660926955182.jpg,headimg/1559660927336705.jpg,headimg/1559660928172402.jpg,headimg/1559660928729346.jpg,headimg/1559660928993838.jpg,headimg/1559660929256004.jpg,headimg/1559660929881796.jpg,headimg/1559660930435553.jpg,headimg/1559660931013053.jpg,headimg/1559660931505410.jpg,headimg/1559660932130461.jpg,headimg/1559660932370260.jpg,headimg/1559660932698707.jpg,headimg/1559660933462252.jpg,headimg/1559660935134430.jpg,headimg/1559660935380193.jpg,headimg/1559660935642974.jpg,headimg/1559660937128057.jpg,headimg/1559660937638561.jpg,headimg/1559660937990466.jpg,headimg/1559660938571673.jpg,headimg/1559660939261615.jpg,headimg/1559660940223428.jpg,headimg/1559660940561335.jpg,headimg/1559660941011181.jpg,headimg/1559660941367810.jpg,headimg/1559660944601443.jpg,headimg/1559660945169999.jpg,headimg/1559660945953003.jpg,headimg/1559660946382869.jpg,headimg/1559660946688907.jpg,headimg/1559660946952023.jpg,headimg/1559660947214511.jpg,headimg/1559660948803835.jpg,headimg/1559660949154797.jpg,headimg/1559660950618926.jpg,headimg/1559660950873481.jpg,headimg/1559660951827076.jpg,headimg/1559660952217672.jpg,headimg/1559660954334910.jpg,headimg/1559660954757667.jpg,headimg/1559660962141087.jpg,headimg/1559660962472689.jpg,headimg/1559660962996896.jpg,headimg/1559660963240590.jpg,headimg/1559660963475066.jpg,headimg/1559660963705622.jpg,headimg/1559660964062379.jpg,headimg/1559660964422257.jpg,headimg/1559660965212709.jpg,headimg/1559660966596033.jpg,headimg/1559660966865937.jpg,headimg/1559660967603524.jpg,headimg/1559660969761870.jpg,headimg/1559660970617418.jpg,headimg/1559660970870139.jpg,headimg/1559660971143059.jpg,headimg/1559660971995885.jpg,headimg/1559660972710149.jpg,headimg/1559660973125361.jpg,headimg/1559660974265623.jpg,headimg/1559660974605960.jpg,headimg/1559660975164980.jpg,headimg/1559660975426701.jpg,headimg/1559660976294456.jpg,headimg/1559660976850044.jpg,headimg/1559660977100281.jpg,headimg/1559660977563543.jpg,headimg/1559660977981288.jpg,headimg/1559660978310261.jpg,headimg/1559660978884228.jpg,headimg/1559660979124854.jpg,headimg/1559660979908848.jpg,headimg/1559660981717509.jpg,headimg/1559660982281631.jpg,headimg/1559660982642780.jpg,headimg/1559660983711139.jpg,headimg/1559660984406901.jpg,headimg/1559660984779719.jpg,headimg/1559660985068123.jpg,headimg/1559660985288736.jpg,headimg/1559660985906885.jpg,headimg/1559660986159118.jpg,headimg/1559660986381514.jpg,headimg/1559660986706784.jpg,headimg/1559660987165964.jpg,headimg/1559660987823238.jpg,headimg/1559660988476488.jpg,headimg/1559660989043858.jpg,headimg/1559660989495130.jpg,headimg/1559660989843011.jpg,headimg/1559660991534460.jpg,headimg/1559660992010615.jpg,headimg/1559660994397116.jpg,headimg/1559660995677245.jpg,headimg/1559660996039230.jpg,headimg/1559660996614745.jpg,headimg/1559660996997345.jpg,headimg/1559660997364251.jpg,headimg/1559660997813999.jpg,headimg/1559660998072822.jpg,headimg/1559660998710789.jpg,headimg/1559660999067087.jpg,headimg/1559660999531108.jpg,headimg/1559661000336255.jpg,headimg/1559661001226837.jpg,headimg/1559661001482205.jpg,headimg/1559661002045114.jpg,headimg/1559661002611217.jpg,headimg/1559661002880294.jpg,headimg/1559661003296196.jpg,headimg/1559661003853757.jpg,headimg/1559661004116693.jpg,headimg/1559661004752075.jpg,headimg/1559661005241492.jpg,headimg/1559661005699124.jpg,headimg/1559661006151182.jpg,headimg/1559661007147498.jpg,headimg/1559661007630489.jpg,headimg/1559661012236416.jpg,headimg/1559661013507942.jpg,headimg/1559661013779356.jpg,headimg/1559661014032141.jpg,headimg/1559661014504752.jpg,headimg/1559661015026922.jpg,headimg/1559661015280852.jpg,headimg/1559661015507848.jpg,headimg/1559661016661502.jpg,headimg/1559661016992174.jpg,headimg/1559661017445384.jpg,headimg/1559661018133445.jpg,headimg/1559661018483454.jpg,headimg/1559661018933742.jpg,headimg/1559661019186172.jpg,headimg/1559661019404004.jpg,headimg/1559661020114733.jpg,headimg/1559661020641683.jpg,headimg/1559661021123003.jpg,headimg/1559661021601610.jpg,headimg/1559661022222009.jpg,headimg/1559661022529218.jpg,headimg/1559661022787960.jpg,headimg/1559661023165937.jpg,headimg/1559661023855073.jpg,headimg/1559661024511160.jpg,headimg/1559661024826764.jpg,headimg/1559661025267715.jpg,headimg/1559661026607899.jpg,headimg/1559661027334758.jpg,headimg/1559661028963550.jpg,headimg/1559661029964111.jpg,headimg/1559661030197496.jpg,headimg/1559661030813335.jpg,headimg/1559661031194586.jpg,headimg/1559661031522758.jpg,headimg/1559661031962772.jpg,headimg/1559661032646596.jpg,headimg/1559661033634998.jpg,headimg/1559661034517354.jpg,headimg/1559661036562614.jpg,headimg/1559661036830293.jpg,headimg/1559661039063732.jpg,headimg/1559661041249205.jpg,headimg/1559661041743231.jpg,headimg/1559661042378118.jpg,headimg/1559661043641776.jpg,headimg/1559661044783702.jpg,headimg/1559661045066521.jpg,headimg/1559661045310748.jpg,headimg/1559661045699847.jpg,headimg/1559661045995536.jpg,headimg/1559661047243373.jpg,headimg/1559661047580802.jpg,headimg/1559661048846230.jpg,headimg/1559661050889998.jpg,headimg/1559661051283469.jpg,headimg/1559661051647570.jpg,headimg/1559661052391381.jpg,headimg/1559661052676496.jpg,headimg/1559661053576747.jpg,headimg/1559661054930811.jpg,headimg/1559661055263000.jpg,headimg/1559661056226519.jpg,headimg/1559661057003387.jpg,headimg/1559661057483860.jpg,headimg/1559661058519008.jpg,headimg/1559661062883019.jpg,headimg/1559661063504661.jpg,headimg/1559661063803923.jpg,headimg/1559661064923510.jpg,headimg/1559661065417092.jpg,headimg/1559661065765431.jpg,headimg/1559661066268075.jpg,headimg/1559661066494876.jpg,headimg/1559661067779394.jpg,headimg/1559661068305335.jpg,headimg/1559661068739291.jpg,headimg/1559661069212387.jpg,headimg/1559661069607254.jpg,headimg/1559661070196017.jpg,headimg/1559661071629381.jpg,headimg/1559661073261600.jpg,headimg/1559661074565195.jpg,headimg/1559661075907346.jpg,headimg/1559661076239999.jpg,headimg/1559661077734646.jpg,headimg/1559661079269093.jpg,headimg/1559661079501860.jpg,headimg/1559661080085367.jpg,headimg/1559661081965802.jpg,headimg/1559661083902008.jpg,headimg/1559661084622538.jpg,headimg/1559661085956011.jpg,headimg/1559661086236952.jpg,headimg/1559661086867097.jpg,headimg/1559661088238674.jpg,headimg/1559661088874484.jpg,headimg/1559661089906509.jpg,headimg/1559661091106519.jpg,headimg/1559661093966665.jpg,headimg/1559661094193336.jpg,headimg/1559661095440795.jpg,headimg/1559661095961315.jpg,headimg/1559661097000854.jpg,headimg/1559661097540606.jpg,headimg/1559661097916143.jpg,headimg/1559661099189643.jpg,headimg/1559661099886917.jpg,headimg/1559661101972688.jpg,headimg/1559661103530285.jpg,headimg/1559661103768931.jpg,headimg/1559661104117270.jpg,headimg/1559661104757734.jpg,headimg/1559661105320756.jpg,headimg/1559661108157417.jpg,headimg/1559661112649157.jpg,headimg/1559661120691028.jpg,headimg/1559661121046339.jpg,headimg/1559661121677859.jpg,headimg/1559661122063537.jpg,headimg/1559661122601383.jpg,headimg/1559661123001236.jpg,headimg/1559661124131916.jpg,headimg/1559661126151136.jpg,headimg/1559661126663738.jpg,headimg/1559661127297468.jpg,headimg/1559661127936786.jpg,headimg/1559661128357515.jpg,headimg/1559661128959208.jpg,headimg/1559661129870493.jpg,headimg/1559661134221699.jpg,headimg/1559661135551158.jpg,headimg/1559661136174784.jpg,headimg/1559661137760621.jpg,headimg/1559661138347190.jpg,headimg/1559661139001452.jpg,headimg/1559661139526808.jpg,headimg/1559661141568488.jpg,headimg/1559661144458811.jpg,headimg/1559661145236804.jpg,headimg/1559661146040809.jpg,headimg/1559661146581446.jpg,headimg/1559661147836691.jpg,headimg/1559661150385790.jpg,headimg/1559661150835452.jpg,headimg/1559661151156265.jpg,headimg/1559661151664368.jpg,headimg/1559661152515613.jpg,headimg/1559661152870775.jpg,headimg/1559661153261664.jpg,headimg/1559661153820373.jpg,headimg/1559661154141434.jpg,headimg/1559661154567996.jpg,headimg/1559661156062576.jpg,headimg/1559661156828633.jpg,headimg/1559661158006507.jpg,headimg/1559661159002852.jpg,headimg/1559661163552127.jpg,headimg/1559661164389655.jpg,headimg/1559661164839491.jpg,headimg/1559661165509279.jpg,headimg/1559661166064676.jpg,headimg/1559661167837033.jpg,headimg/1559661168461294.jpg,headimg/1559661169015759.jpg,headimg/1559661169376530.jpg,headimg/1559661169663132.jpg,headimg/1559661171086257.jpg,headimg/1559661171350703.jpg,headimg/1559661171786563.jpg,headimg/1559661172128423.jpg,headimg/1559661172486981.jpg,headimg/1559661173003821.jpg,headimg/1559661173449419.jpg,headimg/1559661174316485.jpg,headimg/1559661175791927.jpg,headimg/1559661176255458.jpg,headimg/1559661178958422.jpg,headimg/1559661179623330.jpg,headimg/1559661180727522.jpg,headimg/1559661181349774.jpg,headimg/1559661181689596.jpg,headimg/1559661183462566.jpg,headimg/1559661183793763.jpg,headimg/1559661184675791.jpg,headimg/1559661185548834.jpg,headimg/1559661186484429.jpg,headimg/1559661186857229.jpg,headimg/1559661187810227.jpg,headimg/1559661188472532.jpg,headimg/1559661188932581.jpg,headimg/1559661189698218.jpg,headimg/1559661190776767.jpg,headimg/1559661192331370.jpg,headimg/1559661194569955.jpg,headimg/1559661195537185.jpg,headimg/1559661195991234.jpg,headimg/1559661196346709.jpg,headimg/1559661197407445.jpg,headimg/1559661198940905.jpg,headimg/1559661199400210.jpg,headimg/1559661200357747.jpg,headimg/1559661200958671.jpg,headimg/1559661202539054.jpg,headimg/1559661203382291.jpg,headimg/1559661205558934.jpg,headimg/1559661206017667.jpg,headimg/1559661207546149.jpg,headimg/1559661207987876.jpg,headimg/1559661208365877.jpg,headimg/1559661208820286.jpg,headimg/1559661213668892.jpg,headimg/1559661214782398.jpg,headimg/1559661216268066.jpg,headimg/1559661217537978.jpg,headimg/1559661218525789.jpg,headimg/1559661220498872.jpg,headimg/1559661221272376.jpg,headimg/1559661222226941.jpg,headimg/1559661222593388.jpg,headimg/1559661223082949.jpg,headimg/1559661224262039.jpg,headimg/1559661225522845.jpg,headimg/1559661229953557.jpg,headimg/1559661230301895.jpg,headimg/1559661231672268.jpg,headimg/1559661233407823.jpg,headimg/1559661234392253.jpg,headimg/1559661235055162.jpg,headimg/1559661235937472.jpg,headimg/1559661236271525.jpg,headimg/1559661238034399.jpg,headimg/1559661238690073.jpg,headimg/1559661239573125.jpg,headimg/1559661241036104.jpg,headimg/1559661243411142.jpg,headimg/1559661243782280.jpg,headimg/1559661246100976.jpg,headimg/1559661248183499.jpg,headimg/1559661248814203.jpg,headimg/1559661250753557.jpg,headimg/1559661251917472.jpg,headimg/1559661252496540.jpg,headimg/1559661252846431.jpg,headimg/1559661253299764.jpg,headimg/1559661254879656.jpg,headimg/1559661255465143.jpg,headimg/1559661257825566.jpg,headimg/1559661262349943.jpg,headimg/1559661267485702.jpg,headimg/1559661269052099.jpg,headimg/1559661270663658.jpg,headimg/1559661271006403.jpg,headimg/1559661271881165.jpg,headimg/1559661272629888.jpg,headimg/1559661273498137.jpg,headimg/1559661274247072.jpg,headimg/1559661275105923.jpg,headimg/1559661276514328.jpg,headimg/1559661278193776.jpg,headimg/1559661278823253.jpg,headimg/1559661279849021.jpg,headimg/1559661282619083.jpg,headimg/1559661284849192.jpg,headimg/1559661286110820.jpg,headimg/1559661287279431.jpg,headimg/1559661287839735.jpg,headimg/1559661288302030.jpg,headimg/1559661293080021.jpg,headimg/1559661293952413.jpg,headimg/1559661295215789.jpg,headimg/1559661295983543.jpg,headimg/1559661296738574.jpg,headimg/1559661298533864.jpg,headimg/1559661299308428.jpg,headimg/1559661300865181.jpg,headimg/1559661303641981.jpg,headimg/1559661305193627.jpg,headimg/1559661308117642.jpg,headimg/1559661309084158.jpg,headimg/1559661309579664.jpg,headimg/1559661318883395.jpg,headimg/1559661319224329.jpg,headimg/1559661319829262.jpg,headimg/1559661320372695.jpg,headimg/1559661320931966.jpg,headimg/1559661322789637.jpg,headimg/1559661323674750.jpg,headimg/1559661324141205.jpg,headimg/1559661326940860.jpg,headimg/1559661328804335.jpg,headimg/1559661330533078.jpg,headimg/1559661330885033.jpg,headimg/1559661331269552.jpg,headimg/1559661331928536.jpg,headimg/1559661333183936.jpg,headimg/1559661333518497.jpg,headimg/1559661334228392.jpg,headimg/1559661334453444.jpg,headimg/1559661334810876.jpg,headimg/1559661335175338.jpg,headimg/1559661335834619.jpg,headimg/1559661336801874.jpg,headimg/1559661337153866.jpg,headimg/1559661337619517.jpg,headimg/1559661338141272.jpg,headimg/1559661338777260.jpg,headimg/1559661339161612.jpg,headimg/1559661339439275.jpg,headimg/1559661339595863.jpg,headimg/1559661340836445.jpg,headimg/1559661341093912.jpg,headimg/1559661341357613.jpg,headimg/1559661341612123.jpg,headimg/1559661341852179.jpg,headimg/1559661342666973.jpg,headimg/1559661343337977.jpg,headimg/1559661343582809.jpg,headimg/1559661343924378.jpg,headimg/1559661344394315.jpg,headimg/1559661344651079.jpg,headimg/1559661345423089.jpg,headimg/1559661348497586.jpg,headimg/1559661351450660.jpg,headimg/1559661352714539.jpg,headimg/1559661353173815.jpg,headimg/1559661354139118.jpg,headimg/1559661355220384.jpg,headimg/1559661357996972.jpg,headimg/1559661359934097.jpg,headimg/1559661365813052.jpg,headimg/1559661367901787.jpg,headimg/1559661368221962.jpg,headimg/1559661369307429.jpg,headimg/1559661370382547.jpg,headimg/1559661372871256.jpg,headimg/1559661373120003.jpg,headimg/1559661374380371.jpg,headimg/1559661375435827.jpg,headimg/1559661377076376.jpg,headimg/1559661377933182.jpg,headimg/1559661378689145.jpg,headimg/1559661379759036.jpg"
    s = s.split(",")
    mysql_db = db.MysqlDbUtil(mysql_cursor)
    players = mysql_db.query("""SELECT ubp.`id` FROM `user_profile_basic` AS ubp
INNER JOIN `game_player` AS gp ON gp.`userprofilebasic_ptr_id`=ubp.`id`
 WHERE gp.`is_robot` = 1 AND ubp.`headimage`<>'headimg/default1.jpg'""")
    fd = open('data.txt', 'r')
    lines = fd.readlines()
    try:
        for line, user_id, url in zip(lines, players, s):
            user_id = user_id[0]
            print line
            if line:
                d = json.loads(line)
                nick_name = d["nick_name"]
                data = {
                    "id": user_id,
                    "nickname": nick_name.encode('utf8').replace("零钱", "动物世界"),
                    "headimage": url,
                }
                mysql_db.update(data, table_name="user_profile_basic")
    except:
        import traceback
        print traceback.format_exc()
        fd.close()


def upload(remote_url, key):
    ret, info = bucket.fetch(remote_url, bucket_name, key)
    assert ret['key'] == key

if __name__ == "__main__":
    modify_avater()
